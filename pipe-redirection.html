<!DOCTYPE html>
<html lang="cn">
<head>
<!-- 2019-03-12 Tue 10:53 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>管道与重定向</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Cauchy">

<style>code {font-family:Monospace; font-size:90%; background-color: #eee} body {font-size:14pt}
/* @import url(http://fonts.googleapis.com/css?family=Droid+Sans|Droid+Sans+Mono|Droid+Serif); */

html {
    padding: 0;
}

body { 
    font-family: "Droid Serif", "Lucida Grande", "Lucida Sans Unicode", "DejaVu Sans", Verdana, sans-serif;
    font-size: 11pt;
    line-height: 1.3;
    margin: 40pt;
    padding: 0;
}

.title {
/*    background: url(http://orgmode.org/org-mode-unicorn.png) no-repeat 12px 5px; */
/*    position: fixed; */
/*    display: inline; */
    left: 0px;
    top: 0px;
/*    height: 35px; */
    width: 100%;
    margin-top: 0px;
    background-color: #eee;
    padding: 0;
    z-index: 99;
    text-align: center;
}

#orgquote {
    position: fixed;
    display: none;
    top: 77px;
    padding: 5pt;
    text-align: center;
    background-color: black;
    width: 100%;
    color: #ccc;
    box-shadow: 0px 15px 10px #fff;
    font-size: 90%;
    font-family: Courier new;
    z-index: 98;
}

#paypal {
    display: none;
    position:fixed;
    right: 10px;
    top: 15px;
    z-index: 100;
}

#paypal button {
    font-family: Courier new;
    cursor: pointer;
    color: white;
    position:fixed;
    display: none;
    right: 14px;
    top: 15px;
    width: 90px; 
    height: 40px;
    box-shadow: 5px 5px 5px #888;
    -webkit-box-shadow: 5px 5px 5px #888;
    -moz-box-shadow: 5px 5px 5px #888;
    -webkit-border-radius: 10px;
    -moz-border-radius: 10px;
    background-color: #53e1e3;
    font-weight: bold;
}

#paypal button:hover {
    position:fixed;
    display: none;
    right: 9px;
    top: 15px;
    width: 90px; 
    height: 40px;
    margin-top: 5px;
    margin-left: 5px;
    box-shadow: 0px 0px 0px #888;
    -webkit-box-shadow: 0px 0px 0px #888;
    -moz-box-shadow: 0px 0px 0px #888;
    -webkit-border-radius: 10px;
    -moz-border-radius: 10px;
    background-color: #49f4f6;
    font-weight: bold;
}

h1.title {
    text-shadow: 2px 2px 4px #999;
/*    padding-top: 23px; */
/*    padding-left: 70pt; */
/*    font-size: 23pt; */
    font-family: Courier New; 
}

#linklist 
{
    position: fixed;
    font-size: 13pt;
    font-family: Courier New; 
    padding-top: 0px;
    padding-right: 0px;
    top: 107px;
    left: 0px;
    margin-top: 0px;
    width: 180px;
    background-color: #fff;
    color: black;
    box-shadow: 8px 8px 12px #ccc;
    -webkit-border-bottom-right-radius: 10px;
    -moz-border-radius-bottomright: 10px;
    z-index: 100;
}

#linklist a {
    color: black;
    font-weight: normal; 
    text-decoration: none;
    display:block;
    padding: 7pt;
}

#linklist ul {
    margin: 0;
    padding: 0;
}

#linklist li {
    text-align: right;
    margin: 0;
}

.timestamp {
    font-family: Courier New;
    color: #888888;
}

#linklist li:hover {
    border-left: 7px solid #537d7b;
}

pre {
    background-color: #eee;
    font-family: "Droid Sans Mono";
    box-shadow: 2px 2px 2px #888;
    border: none;
    padding: 5pt;
    margin-bottom: 14pt;
    color: black;
/*  padding: 12pt; */
    font-family: Courier New;
    font-size: 85%;
    overflow: auto; 
}

#buttons {
    position: fixed;
    bottom: 10px;
    /* right: 20px; */
    left: 20px;
    z-index: 100;
    width: 100px;
}

.ok {
    -moz-opacity:.2;
    opacity: .2;
    filter:alpha(opacity=20);
}

.ok:hover {
    -moz-opacity:1;
    opacity: 1;
    filter:alpha(opacity=100);
}

.outline-2 {
/*    position: relative; */
    left: 215px;
    top: 105px;
    width: 90%;
    padding-bottom: 5pt;
}

#twit {
    -moz-opacity:.2;
    opacity: .2;
    filter:alpha(opacity=20);
    position: fixed;
    top: 362px;
    box-shadow: 8px 8px 12px #ccc;
    -webkit-border-bottom-right-radius: 10px;
    -moz-border-radius-bottomright: 10px;
    z-index: 100;
}

#twit:hover {
    -moz-opacity:1;
    opacity: 1;
    filter:alpha(opacity=100);

    position: fixed;
    top: 362px;
    box-shadow: 8px 8px 12px #ccc;
    z-index: 100;
}

#outline-container-1 {
    padding-top: 3pt;
}

.outline-2 h2 {
    font-family: Courier New; 
}

.outline-2 h3 {
    font-family: Courier New; 
}

p { 
    margin-top: 0; 
    text-align: justify;
    width: 100%;
}

a:link { 
    font-weight: normal; 
    text-decoration: none; 
    /* color: #1c3030; */
    /* color: #A34D32; */
}

a:visited { 
    font-weight: normal; 
    text-decoration: none; 
    /* color: #5e251e; */
    /* color: #6E2432; */
}

a:hover, a:active { 
    text-decoration: underline; 
    /* color: #3d696a; */
    /* color: #537d7b; */
}

dd {
    text-align: justify;
    margin-bottom: 14pt;
}

dt {
    font-size: 110%;
    font-family: Courier New;
    color: #1c3030;
    /* color: #537d7b; */
    padding: 3px;
    margin-bottom: 3px;
}

li {
    margin: 10px;
    text-align: justify;
/*    list-style-image : url(http://orgmode.org/triangle.png); */
}

#table-of-contents {
    font-size: 9pt;
    position: fixed;
    right: 0em;
    top: 0em;
    background: white;
    -webkit-box-shadow: 0 0 1em #777777;
    -moz-box-shadow: 0 0 1em #777777;
    -webkit-border-bottom-left-radius: 5px;
    -moz-border-radius-bottomleft: 5px;
/*    text-align: right; */
    /* ensure doesn't flow off the screen when expanded */
    max-height: 80%;
    overflow: auto; 
    z-index: 200;
}

#table-of-contents h2 {
    font-size: 9pt;
/*    max-width: 8em; */
    font-weight: normal;
    padding-left: 0.5em;
    padding-top: 0.05em;
    padding-bottom: 0.05em; 
}

#table-of-contents ul {
    margin-left: 14pt; 
    margin-bottom: 10pt;
    padding: 0
}

#table-of-contents li {
    padding: 0;
    margin: 1px;
    list-style: none;
}

#table-of-contents ul>:first-child {
    color: blue;
}

#table-of-contents #text-table-of-contents {
    display: none;
    text-align: left;
}

#table-of-contents:hover #text-table-of-contents {
    display: block;
    padding: 0.5em;
    margin-top: -1.5em; 
}

img.random {
    max-width: 750px;
    max-height: 380px;
    margin-bottom: 10pt;
    border: 1px solid black;
}

@media screen
{
  #table-of-contents {
    float: right;
    border: 1px solid #CCC;
    max-width: 50%;
    overflow: auto;
  }
} /* END OF @media screen */

/*
div.figure {
/*	float: right; 
	width: 30%;
	max-width: 500px;
	min-width: 300px;
/*	border: thin silver solid; 
	margin: 0.3em;
	padding: 0.3em;
}

div.figure p {
	text-align: center;
	font-style: italic;
	font-size: smaller;
	text-indent: 0;	
}

img.scaled{
	width: 50%;
}
*/

/* footer */

div#postamble
{
  clear:both;
  padding-top:0.6em;
  padding-bottom:1em;
  margin-top:3em;
  border-top:1px solid #333333;
}

#postamble p
{
  width:100%;
  text-align:center;
  font-size:0.8em;
  color:#666666;
}

#postamble p.date
{
  width:40%;
  padding-left:2ex;
  float:left;
  text-align:left;
  font-size:0.8em;
  color:#999999;
}
#postamble p.author
{
  clear:both;
  width:40%;
  padding-right:2ex;
  float:right;
  font-size:0.8em;
  color:#999999;
  text-align:right;
  white-space:nowrap;
}
/* footer */

div#postamble
{
  clear:both;
  padding-top:0.6em;
  padding-bottom:1em;
  margin-top:3em;
  border-top:1px solid #333333;
}

#postamble p
{
  width:100%;
  text-align:center;
  font-size:0.8em;
  color:#666666;
}

#postamble p.date
{
  width:40%;
  padding-left:2ex;
  float:left;
  text-align:left;
  font-size:0.8em;
  color:#999999;
}
#postamble p.author
{
  clear:both;
  width:40%;
  padding-right:2ex;
  float:right;
  font-size:0.8em;
  color:#999999;
  text-align:right;
  white-space:nowrap;
}

/* footer */

div#bibliography
{
  margin-top:3em;
  border-top:1px solid #333333;
}
div#postamble
{
  clear:both;
  padding-top:0.6em;
  padding-bottom:1em;
  margin-top:3em;
  border-top:1px solid #333333;
}

#postamble p
{
  width:100%;
  text-align:center;
  font-size:0.8em;
  color:#666666;
}

#postamble p.date
{
  width:40%;
  padding-left:2ex;
  float:left;
  text-align:left;
  font-size:0.8em;
  color:#999999;
}
#postamble p.author
{
  clear:both;
  width:40%;
  padding-right:2ex;
  float:right;
  font-size:0.8em;
  color:#999999;
  text-align:right;
  white-space:nowrap;
}

</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">管道与重定向</h1>
<p>
管道与重定向是Linux系统中基本的概念，本文结合一些实例来验证Linux系统中这两个基础概念。
</p>

<p>
Linux系统中的每一个进程都有关联的三个文件， <code>STDIN</code> ， <code>STDOUT</code> ， <code>STDERR</code> ， 内核为进程打开这三个文件，内核会保证这三个文件的描述符分别为0，1，2。所以用数字来引用这三个文件是安全的。
</p>

<p>
符号 <code>&lt;</code> ， <code>&gt;</code> ， <code>&gt;&gt;</code> 会对一个命令的输出与输入进行重定向。符号 <code>&lt;</code> 使得命令的输入可以从一个已存在的文件中读入。而 <code>&gt;</code> 与 <code>&gt;&gt;</code> 重定向 <code>STDOUT</code> ， <code>&gt;</code> 会替代原文件中的内容，而
<code>&gt;&gt;</code> 只会附接在原文件尾。下面这个命令：
</p>

<pre class="example">
echo "This is a test message." &gt; /tmp/mymessage

</pre>

<p>
将会向 <code>/tmp/mymessage</code> 中写入一行，如果这个文件不存在就先创建它。
</p>

<p>
而下面的例子展示了一个命令如何接受来自已存在文件的输入：
</p>

<pre class="example">
mail -s "Mail test" johndoe &lt; /tmp/mymessage

</pre>

<p>
如你所见， <code>mail</code> 命令接受来自文件 <code>/tmp/mymessage</code> 的信息作为要发送给johndoe邮件的内容。
</p>

<p>
<b>符号&gt;&amp;用来将STDOUT和STDERR重定向到相同的地方。而若只重定向STDERR，用符号2&gt;。</b>
</p>

<p>
下面的例子解释了为什么有时候需要将STDOUT和STDERR重定向到不同的地方。
</p>

<pre class="example">
find / -name core

</pre>

<p>
通常情况下它的执行会引起大量的“权限受限”错误信息，这么多的信息无益于提取有用的信息。这时候符号2&gt;就派上用场了，它可以将错误信息重定向到其它地方：
</p>

<pre class="example">
find / -name core 2&gt; /dev/null

</pre>

<p>
当然，对于有用信息的提取也可以放到一个文件中以便以后来查看：
</p>

<pre class="example">
find / -name core &gt; /tmp/corefiles 2&gt; /dev/null

</pre>

<p>
向 <code>/dev/null</code> 文件中写入信息，实际上就是丢弃这些信息。
</p>

<p>
<b>如果要把一个命令的STDOUT作为另一个命令的STDIN，这就要用到符号|，这就是管道。</b> 下面几个例
 子展示了这种用法：
</p>

<pre class="example">
ps -ef | grep httpd
cut -d: -f7 &lt; /etc/passwd | sort -u

</pre>

<p>
第一个命令中的ps -ef将运行结果输出到grep，而grep的运行结果不再管道到别的地方，就输出到终端窗口。而第二个命令用法类似。
</p>

<p>
使用符号&amp;&amp;连接两个命令，则只有第一个命令成功时，第二个命令才会执行。例如：
</p>

<pre class="example">
lpr /tmp/t2 &amp;&amp; rm /tmp/t2

</pre>
</div>
<div id="postamble" class="status">
<p class="author">Author: Cauchy</p>
<p class="date">Created: 2019-03-12 Tue 10:53</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
